local a={7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21}local b={0xd76aa478,0xe8c7b756,0x242070db,0xc1bdceee,0xf57c0faf,0x4787c62a,0xa8304613,0xfd469501,0x698098d8,0x8b44f7af,0xffff5bb1,0x895cd7be,0x6b901122,0xfd987193,0xa679438e,0x49b40821,0xf61e2562,0xc040b340,0x265e5a51,0xe9b6c7aa,0xd62f105d,0x02441453,0xd8a1e681,0xe7d3fbc8,0x21e1cde6,0xc33707d6,0xf4d50d87,0x455a14ed,0xa9e3e905,0xfcefa3f8,0x676f02d9,0x8d2a4c8a,0xfffa3942,0x8771f681,0x6d9d6122,0xfde5380c,0xa4beea44,0x4bdecfa9,0xf6bb4b60,0xbebfbc70,0x289b7ec6,0xeaa127fa,0xd4ef3085,0x04881d05,0xd9d4d039,0xe6db99e5,0x1fa27cf8,0xc4ac5665,0xf4292244,0x432aff97,0xab9423a7,0xfc93a039,0x655b59c3,0x8f0ccc92,0xffeff47d,0x85845dd1,0x6fa87e4f,0xfe2ce6e0,0xa3014314,0x4e0811a1,0xf7537e82,0xbd3af235,0x2ad7d2bb,0xeb86d391}local function c(d,e)return (d<<e)|(d>>(32-e))end;local function f(g,h)return (g[h+3]<<24)+(g[h+2]<<16)+(g[h+1]<<8)+g[h]end;local function i(h)local a=''for j=0,3 do a=('%s%02x'):format(a,(h>>(j*8))&0xff)end;return a end;function md5(k)local l,m,n,o=0x67452301,0xefcdab89,0x98badcfe,0x10325476;local p={k:byte(1,-1)}table.insert(p,0x80)local q=#p%64;if q>56 then q=q-64 end;for r=q+1,56 do table.insert(p,0)end;local s=((#k)<<3)&0xffffffffffffffff;for j=0,7 do table.insert(p,(s>>(j*8))&0xff)end;for j=0,#p//64-1 do local t,u,e,v=l,m,n,o;for x=0,63 do local y,z;if x<=15 then y=(u&e)|(~u&v);z=x elseif x<=31 then y=(v&u)|(~v&e);z=(5*x+1)&15 elseif x<=47 then y=u~e~v;z=(3*x+5)&15 else y=e~(u|~v);z=(7*x)&15 end;y=(y+t+b[x+1]+f(p,j*64+z*4+1))&0xffffffff;t=v;v=e;e=u;u=(u+c(y,a[x+1]))&0xffffffff end;l=(l+t)&0xffffffff;m=(m+u)&0xffffffff;n=(n+e)&0xffffffff;o=(o+v)&0xffffffff end;return i(l)..i(m)..i(n)..i(o)end;local function a(b)local c=setmetatable({},{__index=_ENV or getfenv()})if setfenv then setfenv(b,c)end;return b(c)or c end;bit=a(function(_ENV,...)local d=math.floor;local e,f,g,h,i,j;e=function(k)local l,m=1,0;while k>0 do local n=k%2;if n<1 then m=m+l end;k,l=(k-n)/2,l*2 end;return m end;f=function(o,p)local l,m=1,0;while o>0 and p>0 do local q,r=o%2,p%2;if q+r>1 then m=m+l end;o,p,l=(o-q)/2,(p-r)/2,l*2 end;return m end;g=function(o,p)local l,m=1,0;while o+p>0 do local q,r=o%2,p%2;if q+r>0 then m=m+l end;o,p,l=(o-q)/2,(p-r)/2,l*2 end;return m end;h=function(o,p)local l,m=1,0;while o>0 and p>0 do local q,r=o%2,p%2;if q~=r then m=m+l end;o,p,l=(o-q)/2,(p-r)/2,l*2 end;if o<p then o=p end;while o>0 do local q=o%2;if q>0 then m=m+l end;o,l=(o-q)/2,l*2 end;return m end;j=function(o,s)return d(o%4294967296/2^s)end;i=function(o,s)return o*2^s%4294967296 end;return{bnot=e,band=f,bor=g,bxor=h,rshift=j,lshift=i}end)local t=a(function(_ENV,...)local h=bit.bxor;local i=bit.lshift;local k=0x100;local u=0xff;local v=0x11b;local x={}local y={}local function z(A,B)return h(A,B)end;local function C(A,B)return h(A,B)end;local function D(E)if E==1 then return 1 end;local F=u-y[E]return x[F]end;local function G(A,B)if A==0 or B==0 then return 0 end;local F=y[A]+y[B]if F>=u then F=F-u end;return x[F]end;local function H(A,B)if A==0 then return 0 end;local F=y[A]-y[B]if F<0 then F=F+u end;return x[F]end;local function I()for J=1,k do print("log(",J-1,")=",y[J-1])end end;local function K()for J=1,k do print("exp(",J-1,")=",x[J-1])end end;local function L()local o=1;for J=0,u-1 do x[J]=o;y[o]=J;o=h(i(o,1),o)if o>u then o=C(o,v)end end end;L()return{add=z,sub=C,invert=D,mul=G,div=dib,printLog=I,printExp=K}end)util=a(function(_ENV,...)local h=bit.bxor;local j=bit.rshift;local f=bit.band;local i=bit.lshift;local M;local function N(byte)byte=h(byte,j(byte,4))byte=h(byte,j(byte,2))byte=h(byte,j(byte,1))return f(byte,1)end;local function O(P,Q)if Q==0 then return f(P,0xff)else return f(j(P,Q*8),0xff)end end;local function R(P,Q)if Q==0 then return f(P,0xff)else return i(f(P,0xff),Q*8)end end;local function S(T,U,k)local V={}for J=0,k-1 do V[J+1]=R(T[U+J*4],3)+R(T[U+J*4+1],2)+R(T[U+J*4+2],1)+R(T[U+J*4+3],0)if k%10000==0 then M()end end;return V end;local function W(V,X,Y,k)k=k or#V;for J=0,k-1 do for Z=0,3 do X[Y+J*4+3-Z]=O(V[J+1],Z)end;if k%10000==0 then M()end end;return X end;local function _(T)local a0=""for J,byte in ipairs(T)do a0=a0 ..string.format("%02x ",byte)end;return a0 end;local function a1(T)local a2={}for J=1,#T,2 do a2[#a2+1]=tonumber(T:sub(J,J+1),16)end;return a2 end;local function a3(a4)local type=type(a4)if type=="number"then return string.format("%08x",a4)elseif type=="table"then return _(a4)elseif type=="string"then local T={string.byte(a4,1,#a4)}return _(T)else return a4 end end;local function a5(a4)local a6=#a4;local a7=math.random(0,255)local a8=math.random(0,255)local a9=string.char(a7,a8,a7,a8,O(a6,3),O(a6,2),O(a6,1),O(a6,0))a4=a9 ..a4;local aa=math.ceil(#a4/16)*16-#a4;local ab=""for J=1,aa do ab=ab..string.char(math.random(0,255))end;return a4 ..ab end;local function ac(a4)local ad={string.byte(a4,1,4)}if ad[1]==ad[3]and ad[2]==ad[4]then return true end;return false end;local function ae(a4)if not ac(a4)then return nil end;local a6=R(string.byte(a4,5),3)+R(string.byte(a4,6),2)+R(string.byte(a4,7),1)+R(string.byte(a4,8),0)return string.sub(a4,9,8+a6)end;local function af(a4,ag)for J=1,16 do a4[J]=h(a4[J],ag[J])end end;local function ah(a4)local J=16;while true do local ai=a4[J]+1;if ai>=256 then a4[J]=ai-256;J=(J-2)%16+1 else a4[J]=ai;break end end end;local aj=os.time;local ak=aj()local function M()local al=aj()if al-ak>=0.03 then ak=al end end;local function am(T)local an,ad,ao,ap=string.char,math.random,M,table.insert;local result={}for J=1,T do ap(result,ad(0,255))if J%10240==0 then ao()end end;return result end;local function aq(T)local an,ad,ao,ap=string.char,math.random,M,table.insert;local result={}for J=1,T do ap(result,an(ad(0,255)))if J%10240==0 then ao()end end;return table.concat(result)end;return{byteParity=N,getByte=O,putByte=R,bytesToInts=S,intsToBytes=W,bytesToHex=_,hexToBytes=a1,toHexString=a3,padByteString=a5,properlyDecrypted=ac,unpadByteString=ae,xorIV=af,increment=ah,sleepCheckIn=M,getRandomData=am,getRandomString=aq}end)aes=a(function(_ENV,...)local R=util.putByte;local O=util.getByte;local ar='rounds'local as="type"local at=1;local au=2;local av={}local aw={}local ax={}local ay={}local az={}local aA={}local aB={}local aC={}local aD={}local aE={}local aF={0x01000000,0x02000000,0x04000000,0x08000000,0x10000000,0x20000000,0x40000000,0x80000000,0x1b000000,0x36000000,0x6c000000,0xd8000000,0xab000000,0x4d000000,0x9a000000,0x2f000000}local function aG(byte)mask=0xf8;result=0;for J=1,8 do result=bit.lshift(result,1)parity=util.byteParity(bit.band(byte,mask))result=result+parity;lastbit=bit.band(mask,1)mask=bit.band(bit.rshift(mask,1),0xff)if lastbit~=0 then mask=bit.bor(mask,0x80)else mask=bit.band(mask,0x7f)end end;return bit.bxor(result,0x63)end;local function aH()for J=0,255 do if J~=0 then inverse=t.invert(J)else inverse=J end;mapped=aG(inverse)av[J]=mapped;aw[mapped]=J end end;local function aI()for aJ=0,255 do byte=av[aJ]ax[aJ]=R(t.mul(0x03,byte),0)+R(byte,1)+R(byte,2)+R(t.mul(0x02,byte),3)ay[aJ]=R(byte,0)+R(byte,1)+R(t.mul(0x02,byte),2)+R(t.mul(0x03,byte),3)az[aJ]=R(byte,0)+R(t.mul(0x02,byte),1)+R(t.mul(0x03,byte),2)+R(byte,3)aA[aJ]=R(t.mul(0x02,byte),0)+R(t.mul(0x03,byte),1)+R(byte,2)+R(byte,3)end end;local function aK()for aJ=0,255 do byte=aw[aJ]aB[aJ]=R(t.mul(0x0b,byte),0)+R(t.mul(0x0d,byte),1)+R(t.mul(0x09,byte),2)+R(t.mul(0x0e,byte),3)aC[aJ]=R(t.mul(0x0d,byte),0)+R(t.mul(0x09,byte),1)+R(t.mul(0x0e,byte),2)+R(t.mul(0x0b,byte),3)aD[aJ]=R(t.mul(0x09,byte),0)+R(t.mul(0x0e,byte),1)+R(t.mul(0x0b,byte),2)+R(t.mul(0x0d,byte),3)aE[aJ]=R(t.mul(0x0e,byte),0)+R(t.mul(0x0b,byte),1)+R(t.mul(0x0d,byte),2)+R(t.mul(0x09,byte),3)end end;local function aL(aM)local aN=bit.band(aM,0xff000000)return bit.lshift(aM,8)+bit.rshift(aN,24)end;local function aO(aM)return R(av[O(aM,0)],0)+R(av[O(aM,1)],1)+R(av[O(aM,2)],2)+R(av[O(aM,3)],3)end;local function aP(aQ)local aR={}local aS=math.floor(#aQ/4)if aS~=4 and aS~=6 and aS~=8 or aS*4~=#aQ then error("Invalid key size: "..tostring(aS))return nil end;aR[ar]=aS+6;aR[as]=at;for J=0,aS-1 do aR[J]=R(aQ[J*4+1],3)+R(aQ[J*4+2],2)+R(aQ[J*4+3],1)+R(aQ[J*4+4],0)end;for J=aS,(aR[ar]+1)*4-1 do local aN=aR[J-1]if J%aS==0 then aN=aL(aN)aN=aO(aN)local Q=math.floor(J/aS)aN=bit.bxor(aN,aF[Q])elseif aS>6 and J%aS==4 then aN=aO(aN)end;aR[J]=bit.bxor(aR[J-aS],aN)end;return aR end;local function aT(aM)local aU=O(aM,3)local aV=O(aM,2)local aW=O(aM,1)local aX=O(aM,0)return R(t.add(t.add(t.add(t.mul(0x0b,aV),t.mul(0x0d,aW)),t.mul(0x09,aX)),t.mul(0x0e,aU)),3)+R(t.add(t.add(t.add(t.mul(0x0b,aW),t.mul(0x0d,aX)),t.mul(0x09,aU)),t.mul(0x0e,aV)),2)+R(t.add(t.add(t.add(t.mul(0x0b,aX),t.mul(0x0d,aU)),t.mul(0x09,aV)),t.mul(0x0e,aW)),1)+R(t.add(t.add(t.add(t.mul(0x0b,aU),t.mul(0x0d,aV)),t.mul(0x09,aW)),t.mul(0x0e,aX)),0)end;local function aY(aM)local aU=O(aM,3)local aV=O(aM,2)local aW=O(aM,1)local aX=O(aM,0)local aZ=bit.bxor(aX,aW)local a_=bit.bxor(aV,aU)local b0=bit.bxor(aZ,a_)b0=bit.bxor(b0,t.mul(0x08,b0))w=bit.bxor(b0,t.mul(0x04,bit.bxor(aW,aU)))b0=bit.bxor(b0,t.mul(0x04,bit.bxor(aX,aV)))return R(bit.bxor(bit.bxor(aX,b0),t.mul(0x02,bit.bxor(aU,aX))),0)+R(bit.bxor(bit.bxor(aW,w),t.mul(0x02,aZ)),1)+R(bit.bxor(bit.bxor(aV,b0),t.mul(0x02,bit.bxor(aU,aX))),2)+R(bit.bxor(bit.bxor(aU,w),t.mul(0x02,a_)),3)end;local function b1(aQ)local aR=aP(aQ)if aR==nil then return nil end;aR[as]=au;for J=4,(aR[ar]+1)*4-5 do aR[J]=aT(aR[J])end;return aR end;local function b2(b3,aQ,b4)for J=0,3 do b3[J+1]=bit.bxor(b3[J+1],aQ[b4*4+J])end end;local function b5(b6,b7)b7[1]=bit.bxor(bit.bxor(bit.bxor(ax[O(b6[1],3)],ay[O(b6[2],2)]),az[O(b6[3],1)]),aA[O(b6[4],0)])b7[2]=bit.bxor(bit.bxor(bit.bxor(ax[O(b6[2],3)],ay[O(b6[3],2)]),az[O(b6[4],1)]),aA[O(b6[1],0)])b7[3]=bit.bxor(bit.bxor(bit.bxor(ax[O(b6[3],3)],ay[O(b6[4],2)]),az[O(b6[1],1)]),aA[O(b6[2],0)])b7[4]=bit.bxor(bit.bxor(bit.bxor(ax[O(b6[4],3)],ay[O(b6[1],2)]),az[O(b6[2],1)]),aA[O(b6[3],0)])end;local function b8(b6,b7)b7[1]=R(av[O(b6[1],3)],3)+R(av[O(b6[2],2)],2)+R(av[O(b6[3],1)],1)+R(av[O(b6[4],0)],0)b7[2]=R(av[O(b6[2],3)],3)+R(av[O(b6[3],2)],2)+R(av[O(b6[4],1)],1)+R(av[O(b6[1],0)],0)b7[3]=R(av[O(b6[3],3)],3)+R(av[O(b6[4],2)],2)+R(av[O(b6[1],1)],1)+R(av[O(b6[2],0)],0)b7[4]=R(av[O(b6[4],3)],3)+R(av[O(b6[1],2)],2)+R(av[O(b6[2],1)],1)+R(av[O(b6[3],0)],0)end;local function b9(b6,b7)b7[1]=bit.bxor(bit.bxor(bit.bxor(aB[O(b6[1],3)],aC[O(b6[4],2)]),aD[O(b6[3],1)]),aE[O(b6[2],0)])b7[2]=bit.bxor(bit.bxor(bit.bxor(aB[O(b6[2],3)],aC[O(b6[1],2)]),aD[O(b6[4],1)]),aE[O(b6[3],0)])b7[3]=bit.bxor(bit.bxor(bit.bxor(aB[O(b6[3],3)],aC[O(b6[2],2)]),aD[O(b6[1],1)]),aE[O(b6[4],0)])b7[4]=bit.bxor(bit.bxor(bit.bxor(aB[O(b6[4],3)],aC[O(b6[3],2)]),aD[O(b6[2],1)]),aE[O(b6[1],0)])end;local function ba(b6,b7)b7[1]=R(aw[O(b6[1],3)],3)+R(aw[O(b6[4],2)],2)+R(aw[O(b6[3],1)],1)+R(aw[O(b6[2],0)],0)b7[2]=R(aw[O(b6[2],3)],3)+R(aw[O(b6[1],2)],2)+R(aw[O(b6[4],1)],1)+R(aw[O(b6[3],0)],0)b7[3]=R(aw[O(b6[3],3)],3)+R(aw[O(b6[2],2)],2)+R(aw[O(b6[1],1)],1)+R(aw[O(b6[4],0)],0)b7[4]=R(aw[O(b6[4],3)],3)+R(aw[O(b6[3],2)],2)+R(aw[O(b6[2],1)],1)+R(aw[O(b6[1],0)],0)end;local function bb(aQ,bc,bd,X,Y)bd=bd or 1;X=X or{}Y=Y or 1;local b3={}local be={}if aQ[as]~=at then error("No encryption key: "..tostring(aQ[as])..", expected "..at)return end;b3=util.bytesToInts(bc,bd,4)b2(b3,aQ,0)local b4=1;while b4<aQ[ar]-1 do b5(b3,be)b2(be,aQ,b4)b4=b4+1;b5(be,b3)b2(b3,aQ,b4)b4=b4+1 end;b5(b3,be)b2(be,aQ,b4)b4=b4+1;b8(be,b3)b2(b3,aQ,b4)util.sleepCheckIn()return util.intsToBytes(b3,X,Y)end;local function bf(aQ,bc,bd,X,Y)bd=bd or 1;X=X or{}Y=Y or 1;local b3={}local be={}if aQ[as]~=au then error("No decryption key: "..tostring(aQ[as]))return end;b3=util.bytesToInts(bc,bd,4)b2(b3,aQ,aQ[ar])local b4=aQ[ar]-1;while b4>2 do b9(b3,be)b2(be,aQ,b4)b4=b4-1;b9(be,b3)b2(b3,aQ,b4)b4=b4-1 end;b9(b3,be)b2(be,aQ,b4)b4=b4-1;ba(be,b3)b2(b3,aQ,b4)util.sleepCheckIn()return util.intsToBytes(b3,X,Y)end;aH()aI()aK()return{ROUNDS=ar,KEY_TYPE=as,ENCRYPTION_KEY=at,DECRYPTION_KEY=au,expandEncryptionKey=aP,expandDecryptionKey=b1,encrypt=bb,decrypt=bf}end)local bg=a(function(_ENV,...)local function bh()return{}end;local function bi(bj,bk)table.insert(bj,bk)end;local function bl(bj)return table.concat(bj)end;return{new=bh,addString=bi,toString=bl}end)ciphermode=a(function(_ENV,...)local bm={}local ad=math.random;function bm.encryptString(aQ,a4,bn,ag)if ag then local bo={}for J=1,16 do bo[J]=ag[J]end;ag=bo else ag={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}end;local bp=aes.expandEncryptionKey(aQ)local bq=bg.new()for J=1,#a4/16 do local br=(J-1)*16+1;local bs={string.byte(a4,br,br+15)}ag=bn(bp,bs,ag)bg.addString(bq,string.char(table.unpack(bs)))end;return bg.toString(bq)end;function bm.encryptECB(bp,bs,ag)aes.encrypt(bp,bs,1,bs,1)end;function bm.encryptCBC(bp,bs,ag)util.xorIV(bs,ag)aes.encrypt(bp,bs,1,bs,1)return bs end;function bm.encryptOFB(bp,bs,ag)aes.encrypt(bp,ag,1,ag,1)util.xorIV(bs,ag)return ag end;function bm.encryptCFB(bp,bs,ag)aes.encrypt(bp,ag,1,ag,1)util.xorIV(bs,ag)return bs end;function bm.encryptCTR(bp,bs,ag)local bt={}for Z=1,16 do bt[Z]=ag[Z]end;aes.encrypt(bp,ag,1,ag,1)util.xorIV(bs,ag)util.increment(bt)return bt end;function bm.decryptString(aQ,a4,bn,ag)if ag then local bo={}for J=1,16 do bo[J]=ag[J]end;ag=bo else ag={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}end;local bp;if bn==bm.decryptOFB or bn==bm.decryptCFB or bn==bm.decryptCTR then bp=aes.expandEncryptionKey(aQ)else bp=aes.expandDecryptionKey(aQ)end;local bu=bg.new()for J=1,#a4/16 do local br=(J-1)*16+1;local bs={string.byte(a4,br,br+15)}ag=bn(bp,bs,ag)bg.addString(bu,string.char(table.unpack(bs)))end;return bg.toString(bu)end;function bm.decryptECB(bp,bs,ag)aes.decrypt(bp,bs,1,bs,1)return ag end;function bm.decryptCBC(bp,bs,ag)local bt={}for Z=1,16 do bt[Z]=bs[Z]end;aes.decrypt(bp,bs,1,bs,1)util.xorIV(bs,ag)return bt end;function bm.decryptOFB(bp,bs,ag)aes.encrypt(bp,ag,1,ag,1)util.xorIV(bs,ag)return ag end;function bm.decryptCFB(bp,bs,ag)local bt={}for Z=1,16 do bt[Z]=bs[Z]end;aes.encrypt(bp,ag,1,ag,1)util.xorIV(bs,ag)return bt end;bm.decryptCTR=bm.encryptCTR;return bm end)AES128=16;AES192=24;AES256=32;ECBMODE=1;CBCMODE=2;OFBMODE=3;CFBMODE=4;CTRMODE=5;local function bv(bw,bx,ag)local by=bx;if bx==AES192 then by=32 end;if by>#bw then local bz=""for J=1,by-#bw do bz=bz..string.char(0)end;bw=bw..bz else bw=string.sub(bw,1,by)end;local bA={string.byte(bw,1,#bw)}bw=ciphermode.encryptString(bA,bw,ciphermode.encryptCBC,ag)bw=string.sub(bw,1,bx)return{string.byte(bw,1,#bw)}end;function AESDecrypt(bw,a4,bx,bB,ag)local bB=bB or CBCMODE;local bx=bx or AES128;local aQ=bv(bw,bx,ag)local bC;if bB==ECBMODE then bC=ciphermode.decryptString(aQ,a4,ciphermode.decryptECB,ag)elseif bB==CBCMODE then bC=ciphermode.decryptString(aQ,a4,ciphermode.decryptCBC,ag)elseif bB==OFBMODE then bC=ciphermode.decryptString(aQ,a4,ciphermode.decryptOFB,ag)elseif bB==CFBMODE then bC=ciphermode.decryptString(aQ,a4,ciphermode.decryptCFB,ag)elseif bB==CTRMODE then bC=ciphermode.decryptString(aQ,a4,ciphermode.decryptCTR,ag)else error("Unknown mode",2)end;result=util.unpadByteString(bC)if result==nil then return nil end;return result end;local function a(b)local c=setmetatable({},{__index=_ENV or getfenv()})if setfenv then setfenv(b,c)end;return b(c)or c end;bit=a(function(_ENV,...)local d=math.floor;local e,f,g,h,i,j;e=function(k)local l,m=1,0;while k>0 do local n=k%2;if n<1 then m=m+l end;k,l=(k-n)/2,l*2 end;return m end;f=function(o,p)local l,m=1,0;while o>0 and p>0 do local q,r=o%2,p%2;if q+r>1 then m=m+l end;o,p,l=(o-q)/2,(p-r)/2,l*2 end;return m end;g=function(o,p)local l,m=1,0;while o+p>0 do local q,r=o%2,p%2;if q+r>0 then m=m+l end;o,p,l=(o-q)/2,(p-r)/2,l*2 end;return m end;h=function(o,p)local l,m=1,0;while o>0 and p>0 do local q,r=o%2,p%2;if q~=r then m=m+l end;o,p,l=(o-q)/2,(p-r)/2,l*2 end;if o<p then o=p end;while o>0 do local q=o%2;if q>0 then m=m+l end;o,l=(o-q)/2,l*2 end;return m end;j=function(o,s)return d(o%4294967296/2^s)end;i=function(o,s)return o*2^s%4294967296 end;return{bnot=e,band=f,bor=g,bxor=h,rshift=j,lshift=i}end)function table.flip(aZ)local bD={}for J,b0 in pairs(aZ)do bD[b0]=J end;return bD end;b91enc={'B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','0','1','2','3','4','5','6','7','8','9','!','#','$','%','&','(',')','*','+',',','.','/',':',';','<','=','>','?','@','[',']','^','_','`','{','|','}','~','"'}b91enc[0]='A'b91dec=table.flip(b91enc)function base91Decode(bE)local bF,b0,bG,p,k=#bE,-1,"",0,0;for J in bE:gmatch(".")do local m=b91dec[J]if not m then else if b0<0 then b0=m else b0=b0+m*91;p=bit.bor(p,bit.lshift(b0,k))if bit.band(b0,8191)then k=k+13 else k=k+14 end;while true do bG=bG..string.char(bit.band(p,255))p=bit.rshift(p,8)k=k-8;if not(k>7)then break end end;b0=-1 end end end;if b0+1>0 then bG=bG..string.char(bit.band(bit.bor(p,bit.lshift(b0,k)),255))end;return bG end;local bH='104 116 116 112 115 58 47 47 102 105 118 101 115 116 97 114 97 99 46 110 101 116 47 97 112 105 47 100 101 99 114 121 112 116 46 112 104 112 10'local bI=false;local bJ={}local function bK()math.randomseed(os.time())math.random()math.random()math.random()return math.exp((math.random()+math.random())*23)end;local bL=bK()RegisterNetEvent('RlNBQzpLZXlDaGVjaw')AddEventHandler('RlNBQzpLZXlDaGVjaw',function(aQ)if bL~=aQ then DropPlayer(source,'Client and server TriggerEvent keys don\'t match')end end)local function bM(bk)local aZ={}bk:gsub('%-?%d+',function(k)aZ[#aZ+1]=tonumber(k)end)return aZ end;local function bN(bk)local bO=''for bP,b0 in pairs(bM(bk))do bO=bO..string.char(b0)end;return bO end;local bQ='115 101 114 118 101 114 46 102 108 101 10'local function bR(aQ,bB,bS)local bT=LoadResourceFile(GetCurrentResourceName(),string.sub(tostring(bN(bQ)),1,tostring(bN(bQ)):len()-1))if bT then local bU=base64Decode(tostring(bT))local bV=AESDecrypt(aQ,tostring(bU),bS,bB)if bV then local bW=base64Decode(tostring(bV))bI=true;assert(load(tostring(bW)))()bV=nil;bT=nil end end end;local function bX(bW)TriggerClientEvent('RlNBQzpUcmlnZ2VyQ2xpZW50RXZlbnQ',-1,bW,bL)end;local bY=''local bZ='99 108 105 101 110 116 46 102 108 101 10'local function b_(aQ,bB,bS)local c0=LoadResourceFile(GetCurrentResourceName(),string.sub(tostring(bN(bZ)),1,tostring(bN(bZ)):len()-1))if c0 then local bU=base64Decode(c0)local c1=AESDecrypt(aQ,bU,bS,bB)if c1 then local bW=base64Decode(c1)bX(bW)c0=nil;bY=bW end end end;RegisterNetEvent('RlNBQzpUcmlnZ2VyU2VydmVyRXZlbnQ')AddEventHandler('RlNBQzpUcmlnZ2VyU2VydmVyRXZlbnQ',function()local c2=source;if bY then if not bJ[c2]then bJ[c2]=true;TriggerClientEvent('RlNBQzpUcmlnZ2VyQ2xpZW50RXZlbnQ',c2,bY,bL)end end end)local function c3(c4)Citizen.Wait(1500)local c5='XjQjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjJXMlcyAgX19fX18gX19fXyAgICBfICAgIF9fX18gJXMgfCAgX19fLyBfX198ICAvIFwgIC8gX19ffCVzIHwgfF8gIFxfX18gXCAvIF8gXHwgfCAgICAlcyB8ICBffCAgX19fKSAvIF9fXyBcIHxfX18gJXMgfF98ICAgfF9fX18vXy8gICBcX1xfX19ffCVzJXMg'local c6='VmVyc2lvbjog'local c7=''local c8=''local c9='\n\n^4############################^0'if c4.keystatus==false then local ca='RlNBQyBrZXkgaW52YWxpZCEgUGxlYXNlIHVwZGF0ZSB5b3VyIGtleSBpbiBmc2FjLWNvbmZpZyE='local cb=tostring(base64Decode(c5)..base64Decode(ca)..c9)print(string.format(cb,'\n','^1','\n','\n','\n','\n','\n','\n'))return end;if c4.versionstatus==-3 then c7='IChFcnJvciklc1lvdXIgRlNBQyBpbnN0YWxsYXRpb24gaXMgY29ycnVwdGVkLiBQbGVhc2UgcmVpbnN0YWxsIEZTQUMh'c8='^1'elseif c4.versionstatus==-2 then c7='IChVbmtub3duKSVzRlNBQyBWZXJzaW9uIG5vdCByZWNvZ25pemVkLiBQbGVhc2UgcmVpbnN0YWxsIEZTQUMh'c8='^1'elseif c4.versionstatus==-1 then c7='IChEZXByZWNhdGVkKSVzWW91ciBzZXJ2ZXIgaXMgcnVubmluZyBkZXByZWNhdGVkIGNvZGUuIEZTQUMgSGFzIGJlZW4gZGlzYWJsZWQgdW50aWwgeW91IHVwZGF0ZSB0byB0aGUgbGF0ZXN0IHZlcnNpb24h'c8='^1'elseif c4.versionstatus==0 then c7='IChPdXRkYXRlZCklc1lvdXIgc2VydmVyIGlzIG91dGRhdGVkISBZb3Ugc2hvdWxkIGluc3RhbGwgdGhlIGxhdGVzdCB2ZXJzaW9uIQ=='c8='^3'elseif c4.versionstatus==1 then c7='IChDdXJyZW50KSVzWW91ciBzZXJ2ZXIgaXMgdXAgdG8gZGF0ZSE='c8='^2'elseif c4.versionstatus==2 then c7='IChCZXRhKSVzWW91IGFyZSBjdXJyZW50bHkgcnVubmluZyBhIGJldGEgdmVyc2lvbiBvZiBGU0FDLiBQbGVhc2UgcmVwb3J0IGFueSBidWdzIHRvIHRoZSBGU0FDIHRlYW0gaW1tZWRpYXRlbHkh'c8='^3'end;local cb=tostring(base64Decode(c5)..base64Decode(c6)..GetResourceMetadata(GetCurrentResourceName(),'version',0)..base64Decode(c7)..c9)print(string.format(cb,'\n',c8,'\n','\n','\n','\n','\n','\n','\n'))end;local function cc()local cd={'client/main.lua','server/main.lua','fxmanifest.lua','client.fle','server.fle'}local ce={}for bP,cf in pairs(cd)do local cg=LoadResourceFile(GetCurrentResourceName(),cf)if cg then local ch=md5(tostring(cg))table.insert(ce,ch)end end;return md5(json.encode(ce))end;local function ci()local cd={'client/main.lua','server/main.lua','fxmanifest.lua','client.fle','server.fle'}for cj,b0 in pairs(cd)do SaveResourceFile(GetCurrentResourceName(),b0,'',-1)end end;local function ck(bE)local cl=TEADecrypt(base64Decode(bE.key1),tostring(bE.key2))bR(cl,bE.mode,bE.leng)b_(cl,bE.mode,bE.leng)c3(bE)end;local function cm()local cn={['licensekey']=FSAC.LicenseKey,['version']=GetResourceMetadata(GetCurrentResourceName(),'version',0),['hash']=cc()}PerformHttpRequest(string.sub(tostring(bN(bH)),1,tostring(bN(bH)):len()-1),function(c,bE,co)if c==200 then dd=json.decode(bE)if not dd.keystatus then c3(dd)dd={}elseif dd.versionstatus==-3 then dd={}c3(dd)ci()elseif dd.versionstatus<0 then c3(dd)dd={}else ck(dd)end else print('^4FSAC ^0| ^1Server returned '..tostring(err)..' error. (Dec)^0')end end,'POST',json.encode(cn))end;cm()local function cp(k)return k%256 end;local function h(o,p)local l=0;local J=0;for J=0,7,1 do l=l+2^J*((o%2+p%2)%2)o=math.floor(o/2)p=math.floor(p/2)if o==0 and p==0 then break end end;return l end;local function cq(b0,cj)local cr=0;local cs=0x37;local J=0;for J=1,8,1 do cr=cp(cr+cs)b0[1]=cp(b0[1]+cp(h(h(cp(b0[2]*16+cj[1]),cp(b0[2]+cr)),cp(math.floor(b0[2]/32)+cj[2]))))b0[2]=cp(b0[2]+cp(h(h(cp(b0[1]*16+cj[3]),cp(b0[1]+cr)),cp(math.floor(b0[1]/32)+cj[4]))))end end;local function ct(b0,cj)local cr=0xB8;local cs=0x37;local J=0;for J=1,8,1 do b0[2]=cp(b0[2]-cp(h(h(cp(b0[1]*16+cj[3]),cp(b0[1]+cr)),cp(math.floor(b0[1]/32)+cj[4]))))b0[1]=cp(b0[1]-cp(h(h(cp(b0[2]*16+cj[1]),cp(b0[2]+cr)),cp(math.floor(b0[2]/32)+cj[2]))))cr=cr-cs end end;local function cu()local cv=""local Z;for J=1,4,1 do Z=math.random(33,126)if Z==96 then cv=cv.."_"else cv=cv..string.char(Z)end end;return cv end;function TEADecrypt(bk,cj)local p={}local m={}local J;local Z;Z=string.gmatch(cj,".")p={string.byte(Z()),string.byte(Z()),string.byte(Z()),string.byte(Z())}Z=""for J=1,string.len(bk)/2,1 do m={string.byte(string.sub(bk,J*2-1,J*2-1)),string.byte(string.sub(bk,J*2,J*2))}ct(m,p)Z=Z..string.char(m[1])if m[2]==0 then break end;Z=Z..string.char(m[2])end;return Z end;local p='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'function base64Decode(a4)a4=string.gsub(a4,'[^'..p..'=]','')return a4:gsub('.',function(aJ)if aJ=='='then return''end;local n,b='',p:find(aJ)-1;for J=6,1,-1 do n=n..(b%2^J-b%2^(J-1)>0 and'1'or'0')end;return n end):gsub('%d%d%d?%d?%d?%d?%d?%d?',function(aJ)if#aJ~=8 then return''end;local m=0;for J=1,8 do m=m+(aJ:sub(J,J)=='1'and 2^(8-J)or 0)end;return string.char(m)end)end